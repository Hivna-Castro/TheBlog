<body>

  <header>
    <nav>
      <ul>
        <p>TheBlog</p>
        <% if logged_in? %>
          <li><%= link_to 'Novo Post', new_post_path %></li>
          <li><%= link_to 'Meus Posts', my_posts_posts_path %></li>
          <li><%= link_to 'Configurações', edit_user_path(current_user) %></li>
          <li><%= link_to t('logout'), logout_path %></li>
        <% else %>
          <li><%= link_to 'Login', login_path %></li>
          <li><%= link_to 'Cadastro', signup_path %></li>
        <% end %>
      </ul>
    </nav>
  </header>

  <main>
    <section class="dashboard">
     
      <div class="tags-filter">
        <h3>Filtrar por tags:</h3>
        <%= form_with url: posts_path, method: :get, local: true do |form| %>
          <%= form.label :tag, "Selecione uma tag:", class: "filter-label" %>
          <%= form.select :tag, Tag.joins(:posts).distinct.pluck(:name), include_blank: "Todas as tags", selected: params[:tag], class: "filter-select" %>
          <%= form.submit "Filtrar", class: "filter-button" %>
        <% end %>
      </div>

   
      <div class="posts">
        <h2>Posts Recentes</h2>
        <% @posts.each do |post| %>
          <div class="post">
            <h3><%= post.title %></h3>
            <p><%= post.content.truncate(200) %></p>
            <% if post.tags.any? %>
              <p>Tags: <%= post.tags.map(&:name).join(", ") %></p>
            <% end %>
            <p><small>Publicado em: <%= post.created_at.strftime('%d/%m/%Y') %></small></p>
            <%= link_to 'Leia mais...', post_path(post) %>
          </div>
        <% end %>
        
        <div class="pagination">
          <%= paginate @posts %>
        </div>
      </div>
    </section>
  </main>
  
  <footer>
    <p>&copy; <%= Time.now.year %> Meu Blog. Todos os direitos reservados.</p>
  </footer>
</body>
